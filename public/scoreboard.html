<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <style>
    body {
      margin: 0;
      padding: 0;
      background: transparent;
    }

    .container {
        position: absolute;
        top: 20px;
        left: 20px;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .scoreboard-and-panels {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
        transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
        transform: translateX(-90px);
        z-index: 10;
        position: relative;
    }
    
    .scoreboard-and-panels.shifted {
        transform: translateX(0);
    }
    
    .scoreboard-and-panels.hidden {
        opacity: 0;
        pointer-events: none;
    }
    
    .sponsor-logo-box {
        width: 80px;
        height: 80px;
        background: transparent;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
    }
    
    .sponsor-logo-box.visible {
        opacity: 1;
    }

    .sponsor-logo-box img {
        max-height: 100%;
        max-width: 100%;
        object-fit: contain;
    }

    .scoreboard {
      display: flex;
      align-items: center;
      background: #141414;
      border-radius: 12px;
      overflow: hidden;
      font-family: "Segoe UI", Arial, sans-serif;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
    }
    
    .timer-wrapper {
      background: #02271f;
      border-radius: 12px 0 0 12px;
      overflow: hidden;
    }

    .team-section {
        display: flex;
        align-items: center;
        flex-grow: 1;
        padding: 8px 8px;
        min-width: 100px;
        justify-content: space-between;
        background: #033931;
    }

    .team-section.away {
        flex-direction: row;
        justify-content: space-between;
    }
    
    .team-section.home {
        flex-direction: row-reverse;
        justify-content: space-between;
    }

    .team-logo-container {
      height: 44px;
      width: 8px;
      border-radius: 6px;
      background-position: center;
      background-size: contain;
      background-repeat: no-repeat;
      transition: width 0.3s ease-in-out, margin 0.3s ease-in-out;
    }

    .team-logo-container.has-logo {
        width: 44px;
        margin: 0 10px;
    }
    
    .team-section.home .team-logo-container {
        margin-left: 10px;
    }

    .team-section.away .team-logo-container {
        margin-right: 10px;
    }

    .team-section .name {
      font-size: 24px;
      font-weight: 600;
      color: white;
      text-shadow: 1px 1px 2px black;
      flex: 1;
      white-space: nowrap;
      overflow: visible;
      text-overflow: clip;
      padding: 0 10px;
    }
    
    .team-section.home .name {
        text-align: right;
    }

    .team-section.away .name {
        text-align: left;
    }

    .score {
      font-size: 32px;
      font-weight: bold;
      padding: 8px 10px;
      background: #141414;
      color: #fff;
      min-width: 50px;
      text-align: center;
      border-left: 2px solid #555;
      border-right: 2px solid #555;
      flex-shrink: 0;
    }

    .timerbox {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 11px 12px;
      background: transparent;
      width: 75px;
      flex-shrink: 0;
    }

    .main-timer {
      font-size: 28px;
      font-weight: 600;
      color: #fff;
      transform: translateY(-2px);
    }

    .extra-time-box {
        display: flex;
        align-items: center;
        background: #8B0000;
        color: #fff;
        padding: 5px 10px;
        border-radius: 6px;
        white-space: nowrap;
        opacity: 0;
        transition: opacity 0.5s ease;
        margin-left: 9px; 
        align-self: flex-start;
    }

    .extra-time-box.visible {
        opacity: 1;
    }
    
    .extra-timer {
        font-size: 16px;
        font-weight: bold;
    }

    .extra-text {
        font-size: 16px;
        font-weight: bold;
        margin-left: 8px;
        color: white;
    }
    
    .half {
      font-size: 14px;
      color: #ddd;
    }
    
    .status-message-box {
        position: absolute;
        top: 7px;
        background-color: #007acc;
        color: white;
        padding: 10px 15px;
        border-radius: 8px;
        font-family: "Segoe UI", Arial, sans-serif;
        font-size: 20px;
        font-weight: bold;
        box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        opacity: 0;
        transform: translateX(-500px);
        transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
        z-index: -1;
        white-space: nowrap;
        left: calc(100% + 10px);
    }
    
    .status-message-box.slide-in {
        opacity: 1;
        transform: translateX(0);
    }
    
    .status-message-box.slide-out {
        opacity: 0;
        transform: translateX(-500px);
    }

    .status-message-box.hidden-fade {
        opacity: 0;
        pointer-events: none;
        transform: translateX(0);
    }
    
  </style>
</head>
<body>
  <div class="container">
    <div class="sponsor-logo-box" id="sponsorLogoBox">
        <img id="sponsorLogo" src="" alt="Sponsor Logosu">
    </div>

    <div class="scoreboard-and-panels" id="scoreboardAndPanels">
      <div class="scoreboard" id="board">
        <div class="timer-wrapper">
          <div class="timerbox">
            <div class="main-timer" id="timer">00:00</div>
          </div>
        </div>

        <div class="team-section home" id="home">
          <span class="name">Takım A</span>
          <div id="homeLogoContainer" class="team-logo-container"></div>
        </div>

        <div class="score" id="score">0 - 0</div>

        <div class="team-section away" id="away">
          <span class="name">Takım B</span>
          <div id="awayLogoContainer" class="team-logo-container"></div>
        </div>
      </div>
      
      <div class="extra-time-box" id="extraDisplay">
        <span class="extra-timer" id="extraTimer">00:00</span>
        <span class="extra-text" id="extraText"></span>
      </div>
      
      <div class="status-message-box" id="statusMessageBox">
          <span id="statusMessageText"></span>
      </div>
    </div>
  </div>

  <script>
    // --- YENİ KOD BAŞLANGICI: DİNAMİK BAĞLANTI ---
    const renderUrl = "soccer-scoreboard-by-trooxie.onrender.com";

    // 1. URL'den ID'yi alırız (Örn: /board/a1b2c3d4 => a1b2c3d4)
    const pathSegments = window.location.pathname.split('/');
    const boardId = pathSegments[pathSegments.length - 1]; 
    
    // Güvenli WebSocket bağlantısını ID'ye özel kurarız. wss://[adres]/[boardId]
    const ws = new WebSocket(`wss://${renderUrl}/${boardId}`);
    // --- YENİ KOD BİTİŞİ ---

    const extraDisplay = document.getElementById("extraDisplay");
    const sponsorLogo = document.getElementById("sponsorLogo");
    const sponsorLogoBox = document.getElementById("sponsorLogoBox");
    
    const scoreboardAndPanels = document.getElementById("scoreboardAndPanels");
    const scoreboard = document.getElementById("board");
    const statusMessageBox = document.getElementById("statusMessageBox");
    const statusMessageText = document.getElementById("statusMessageText");
    const awayLogoContainer = document.getElementById('awayLogoContainer');

    let previousIsScoreboardVisible;
    let previousMatchStatusMessage;

    function hexToRgba(hex, alpha) {
        let r = parseInt(hex.slice(1, 3), 16);
        let g = parseInt(hex.slice(3, 5), 16);
        let b = parseInt(hex.slice(5, 7), 16);
        return `rgba(${r}, ${g}, ${b}, ${alpha})`;
    }

    ws.onmessage = e => {
      const data = JSON.parse(e.data);
      if (data.action === "state" || data.action === "init") {
        const s = data.state;
        
        if (s.isScoreboardVisible) {
            scoreboardAndPanels.classList.remove('hidden');
        } else {
            scoreboardAndPanels.classList.add('hidden');
        }
        
        document.querySelector("#home .name").innerText = s.homeTeam;
        document.querySelector("#away .name").innerText = s.awayTeam;
        
        document.getElementById("score").innerText = s.homeScore + " - " + s.awayScore;
        
        const homeLogoContainer = document.getElementById('homeLogoContainer');
        const awayLogoContainer = document.getElementById('awayLogoContainer');
        
        document.querySelector(".timer-wrapper").style.backgroundColor = hexToRgba(s.timerBgColor, s.timerOpacity);
        document.querySelector(".team-section.home").style.backgroundColor = hexToRgba(s.teamBgColor, s.teamOpacity);
        document.querySelector(".team-section.away").style.backgroundColor = hexToRgba(s.teamBgColor, s.teamOpacity);
        document.querySelector(".extra-time-box").style.backgroundColor = hexToRgba(s.extraTimeBgColor, s.extraTimeOpacity);
        document.querySelector(".scoreboard").style.backgroundColor = hexToRgba(s.scoreboardBgColor, s.scoreboardOpacity);
        document.querySelector(".score").style.backgroundColor = hexToRgba(s.scoreboardBgColor, s.scoreboardOpacity);

        if (s.homeLogo) {
            homeLogoContainer.style.backgroundImage = `url(${s.homeLogo})`;
            homeLogoContainer.style.backgroundColor = 'transparent';
            homeLogoContainer.classList.add('has-logo');
        } else {
            homeLogoContainer.style.backgroundImage = 'none';
            homeLogoContainer.style.backgroundColor = s.homeColor;
            homeLogoContainer.classList.remove('has-logo');
        }

        if (s.awayLogo) {
            awayLogoContainer.style.backgroundImage = `url(${s.awayLogo})`;
            awayLogoContainer.style.backgroundColor = 'transparent';
            awayLogoContainer.classList.add('has-logo');
        } else {
            awayLogoContainer.style.backgroundImage = 'none';
            awayLogoContainer.style.backgroundColor = s.awayColor;
            awayLogoContainer.classList.remove('has-logo');
        }

        document.querySelector("#home .name").style.color = s.homeColor;
        document.querySelector("#away .name").style.color = s.awayColor;

        let min = Math.floor(s.timer / 60);
        let sec = s.timer % 60;
        document.getElementById("timer").innerText =
          `${min.toString().padStart(2, "0")}:${sec.toString().padStart(2, "0")}`;

        if (s.isExtraTimeRunning && s.extra > 0) {
          document.getElementById("extraText").innerText = "+" + s.extra;
          let extraMin = Math.floor(s.extraTimer / 60);
          let extraSec = s.extraTimer % 60;
          document.getElementById("extraTimer").innerText = `${extraMin.toString().padStart(2, "0")}:${extraSec.toString().padStart(2, "0")}`;
          extraDisplay.classList.add("visible");
        } else {
          extraDisplay.classList.remove("visible");
        }
        
        if (s.sponsorLogo) {
          sponsorLogo.src = s.sponsorLogo;
          scoreboardAndPanels.classList.add('shifted');
          sponsorLogoBox.classList.add('visible');
        } else {
          scoreboardAndPanels.classList.remove('shifted');
          sponsorLogoBox.classList.remove('visible');
        }

        if (s.isScoreboardVisible) {
            statusMessageBox.classList.remove('hidden-fade');
        } else {
            statusMessageBox.classList.add('hidden-fade');
        }

        if (s.matchStatusMessage) {
            statusMessageText.innerText = s.matchStatusMessage;
            if (s.isScoreboardVisible) {
                statusMessageBox.classList.add('slide-in');
                statusMessageBox.classList.remove('slide-out');
            } else {
                statusMessageBox.classList.remove('slide-in');
                statusMessageBox.classList.remove('slide-out');
            }
        } else {
            statusMessageBox.classList.remove('slide-in');
            statusMessageBox.classList.add('slide-out');
        }
        
        previousIsScoreboardVisible = s.isScoreboardVisible;
        previousMatchStatusMessage = s.matchStatusMessage;
      }
    };
  </script>
</body>

</html>