<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Kontrol Paneli</title>
  <style>
    body { background:#1e1e1e; color:white; font-family:Arial, sans-serif; padding:20px; display: flex; flex-direction: column; gap: 20px; }
    div { background: #2a2a2a; padding: 15px; border-radius: 8px; border: 1px solid #444; }
    h2, h3 { border-bottom: 2px solid #00aaff; padding-bottom: 5px; margin-top: 0; }
    input, button { margin:5px; padding:8px 12px; border-radius: 5px; border: 1px solid #555; background: #333; color: white; }
    button { cursor: pointer; background: #007acc; border: none; border-radius: 5px; font-weight: bold; transition: background 0.3s; }
    button.remove-btn { background: #cc0000; }
    button:hover { background: #005f99; }
    button.remove-btn:hover { background: #990000; }
    input[type="color"] { padding: 0; height: 30px; width: 50px; vertical-align: middle; }
    input[type="file"] { border: none; }
    #scoreDisplay { font-size: 2em; font-weight: bold; }
    .color-input { width: 40px; }
    .opacity-container { display: flex; align-items: center; }
    .opacity-container label { margin-right: 5px; }
    .opacity-container input[type="range"] { width: 100px; }
    
    
    #obs-url-section {
        display: flex;
        flex-direction: column;
        gap: 10px;
        background: #1a1a1a;
    }
    #obsUrlDisplay {
        font-family: 'Courier New', Courier, monospace;
        background: #333;
        padding: 10px;
        border-radius: 4px;
        overflow-x: auto;
        white-space: nowrap;
        user-select: none; 
    }
    .blurred {
        filter: blur(4px);
        transition: filter 0.3s;
    }
    .blurred:hover {
        filter: blur(0);
    }
    #notification {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #4CAF50;
        color: white;
        padding: 15px 25px;
        border-radius: 5px;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.5s, transform 0.5s;
        transform: translateY(100%);
    }
    #notification.show {
        opacity: 1;
        transform: translateY(0);
    }
  </style>
</head>
<body>
  <h1>Skorbord Kontrol Paneli</h1>

  <div id="obs-url-section">
    <h3>OBS Tarayıcı Kaynağı URL'si</h3>
    <p>Bu URL'yi OBS'deki "Tarayıcı" kaynağına kopyalayın. Gizlilik için farenizle üzerine gelene kadar URL bulanıktır.</p>
    <p>NOT: Kontrol Paneli'nin url uzantısını kimseye vermeyiniz, url ye sahip olan herkes Scoreboardınızı kontrol edebilir.</p>
    
    <div id="obsUrlDisplay" class="blurred">
        URL Yükleniyor...
    </div>
    
    <button onclick="copyToClipboard('obsUrlDisplay')">
        OBS URL'sini Kopyala
    </button>
  </div>
  
  <div>
    <h3>Skorbord Görünürlüğü</h3>
    <button onclick="toggleScoreboard()">Skorbordu Gizle / Göster</button>
  </div>
  
  <div>
    <h3>Maç Ayarları</h3>
    <input type="text" id="homeTeamName" placeholder="Ev Sahibi Takım Adı">
    <input type="text" id="awayTeamName" placeholder="Deplasman Takım Adı">
    <button onclick="updateTeamNames()">Takım İsimlerini Güncelle</button>
  </div>

  <div>
    <h3>Takım Renkleri</h3>
    Ev Sahibi: <input type="color" id="homeColor" value="#0066ff">
    Deplasman: <input type="color" id="awayColor" value="#ff3333">
    <button onclick="updateColors()">Renkleri Güncelle</button>
  </div>
  
  <div>
    <h3>Skorbord Arka Plan Renkleri</h3>
    <div class="opacity-container">
      <label for="timerBgColor">Sayaç Arka Plan:</label>
      <input type="color" id="timerBgColor" value="#02271f">
      <label for="timerOpacity">Opaklık:</label>
      <input type="range" id="timerOpacity" min="0" max="1" step="0.1" value="1">
    </div>
    <div class="opacity-container">
      <label for="teamBgColor">Takım Bölümleri Arka Plan:</label>
      <input type="color" id="teamBgColor" value="#033931">
      <label for="teamOpacity">Opaklık:</label>
      <input type="range" id="teamOpacity" min="0" max="1" step="0.1" value="1">
    </div>
    <div class="opacity-container">
      <label for="extraTimeBgColor">Ek Süre Arka Plan:</label>
      <input type="color" id="extraTimeBgColor" value="#8B0000">
      <label for="extraTimeOpacity">Opaklık:</label>
      <input type="range" id="extraTimeOpacity" min="0" max="1" step="0.1" value="1">
    </div>
    <div class="opacity-container">
      <label for="scoreboardBgColor">Genel Skorbord Arka Plan:</label>
      <input type="color" id="scoreboardBgColor" value="#141414">
      <label for="scoreboardOpacity">Opaklık:</label>
      <input type="range" id="scoreboardOpacity" min="0" max="1" step="0.1" value="1">
    </div>
    <br>
    <button onclick="updateBackgroundColors()">Renkleri Güncelle</button>
    <button onclick="sendAction('resetBackgroundColors')" class="remove-btn">Renkleri Sıfırla</button>
  </div>

  <div>
    <h3>Takım Logoları</h3>
    Ev Sahibi Logo: <input type="file" id="homeLogoFile" accept="image/*">
    <button onclick="uploadLogo('home')">Yükle</button>
    <button onclick="removeLogo('home')" class="remove-btn">Ev Sahibi Logoyu Kaldır</button>
    <br>
    Deplasman Logo: <input type="file" id="awayLogoFile" accept="image/*">
    <button onclick="uploadLogo('away')">Yükle</button>
    <button onclick="removeLogo('away')" class="remove-btn">Deplasman Logoyu Kaldır</button>
  </div>
  
  <div>
    <h3>Sponsor Logosu</h3>
    <input type="file" id="sponsorLogoFile" accept="image/*">
    <button onclick="uploadSponsorLogo()">Yükle</button>
    <button onclick="removeSponsorLogo()" class="remove-btn">Sponsor Logoyu Kaldır</button>
  </div>

  <div>
    <h3>Skor Kontrolü</h3>
    <span id="scoreDisplay">0 - 0</span>
    <br>
    <button onclick="changeScore('home', 1)">Ev Sahibi (+1)</button>
    <button onclick="changeScore('home', -1)">Ev Sahibi (-1)</button>
    <button onclick="changeScore('away', 1)">Deplasman (+1)</button>
    <button onclick="changeScore('away', -1)">Deplasman (-1)</button>
  </div>

  <div>
    <h3>Maç Sayacı</h3>
    <button onclick="sendAction('toggleTimer')">Başlat / Durdur</button>
    <button onclick="sendAction('resetTimer')">Sıfırla</button>
    <br>
    <label for="manualTimerMinutes">Manuel Ayar:</label>
    <input type="number" id="manualTimerMinutes" min="0" value="0" style="width: 50px;">
    <span>dakika</span>
    <input type="number" id="manualTimerSeconds" min="0" max="59" value="0" style="width: 50px;">
    <span>saniye</span>
    <button onclick="setManualTimer()">Ayarla</button>
  </div>

  <div>
    <h3>Ek Süre</h3>
    <label for="extraTime1">1. Yarı Ek Süre:</label>
    <input type="number" id="extraTime1" min="0" value="0">
    <label for="extraTime2">2. Yarı Ek Süre:</label>
    <input type="number" id="extraTime2" min="0" value="0">
    <button onclick="setExtraTimes()">Ek Süreyi Belirle</button>
    <br>
    <button onclick="sendAction('resetExtraTime')">Uzatmayı Sıfırla ve Gizle</button>
  </div>
  
  <div>
    <h3>Maçın Yarısı ve Durum Bildirimleri</h3>
    <button onclick="sendAction('startFirstHalf')">1. Yarıyı Başlat</button>
    <button onclick="sendAction('startSecondHalf')">2. Yarıyı Başlat</button>
    <br>
    <button onclick="sendAction('showHalfTime')">Devre Arası Göster</button>
    <button onclick="sendAction('showFullTime')">Maç Sonu Göster</button>
    <button onclick="sendAction('hideStatusMessage')" class="remove-btn">Bildirimi Gizle</button>
  </div>

  <div>
    <h3>Maçı Sıfırla</h3>
    <button onclick="sendAction('resetAll')" class="remove-btn">Tüm Maçı Sıfırla</button>
  </div>
  
  <div id="notification"></div>

  <script>
    const renderUrl = "soccer-scoreboard-by-trooxie.onrender.com";
    
    
    const pathSegments = window.location.pathname.split('/');
    const boardId = pathSegments[pathSegments.length - 1]; 

    
    const obsUrl = `${window.location.protocol}//${window.location.host}/board/${boardId}`;
    document.getElementById("obsUrlDisplay").innerText = obsUrl;

    
    const ws = new WebSocket(`wss://${renderUrl}/${boardId}`);
    
    let scoreboardState = { homeScore: 0, awayScore: 0 };
    
    
    function showNotification(message) {
        const notification = document.getElementById('notification');
        notification.innerText = message;
        notification.classList.add('show');
        
        
        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    }

    async function copyToClipboard(elementId) {
        const textToCopy = document.getElementById(elementId).innerText;
        try {
            await navigator.clipboard.writeText(textToCopy);
            showNotification('OBS URL’si başarıyla kopyalandı!');
        } catch (err) {
            console.error('Kopyalama başarısız oldu:', err);
            showNotification('Kopyalama başarısız oldu. Lütfen manuel kopyalayın.');
        }
    }

    ws.onmessage = e => {
      const data = JSON.parse(e.data);
      if (data.action === "state" || data.action === "init") {
          const s = data.state;
          scoreboardState = s;
          document.getElementById("scoreDisplay").innerText = `${s.homeScore} - ${s.awayScore}`;
          
          document.getElementById("timerBgColor").value = s.timerBgColor;
          document.getElementById("timerOpacity").value = s.timerOpacity;
          document.getElementById("teamBgColor").value = s.teamBgColor;
          document.getElementById("teamOpacity").value = s.teamOpacity;
          document.getElementById("extraTimeBgColor").value = s.extraTimeBgColor;
          document.getElementById("extraTimeOpacity").value = s.extraTimeOpacity;
          document.getElementById("scoreboardBgColor").value = s.scoreboardBgColor;
          document.getElementById("scoreboardOpacity").value = s.scoreboardOpacity;
      }
    };

    function updateTeamNames() {
      const homeTeamName = document.getElementById("homeTeamName").value;
      const awayTeamName = document.getElementById("awayTeamName").value;
      ws.send(JSON.stringify({ action: "updateTeamNames", homeTeamName, awayTeamName }));
    }

    function updateColors() {
      const homeColor = document.getElementById("homeColor").value;
      const awayColor = document.getElementById("awayColor").value;
      ws.send(JSON.stringify({ action: "updateColors", homeColor, awayColor }));
    }
    
    function updateBackgroundColors() {
      const timerBgColor = document.getElementById("timerBgColor").value;
      const timerOpacity = parseFloat(document.getElementById("timerOpacity").value);
      const teamBgColor = document.getElementById("teamBgColor").value;
      const teamOpacity = parseFloat(document.getElementById("teamOpacity").value);
      const extraTimeBgColor = document.getElementById("extraTimeBgColor").value;
      const extraTimeOpacity = parseFloat(document.getElementById("extraTimeOpacity").value);
      const scoreboardBgColor = document.getElementById("scoreboardBgColor").value;
      const scoreboardOpacity = parseFloat(document.getElementById("scoreboardOpacity").value);
      
      ws.send(JSON.stringify({ 
          action: "updateBackgroundColors", 
          timerBgColor, timerOpacity, 
          teamBgColor, teamOpacity, 
          extraTimeBgColor, extraTimeOpacity,
          scoreboardBgColor, scoreboardOpacity
      }));
    }

    function uploadLogo(team) {
      const fileInput = document.getElementById(team + "LogoFile");
      if (fileInput.files[0]) {
        const reader = new FileReader();
        reader.onload = () => {
          ws.send(JSON.stringify({
            action: "uploadLogo",
            team: team,
            logo: reader.result
          }));
        };
        reader.readAsDataURL(fileInput.files[0]);
      }
    }
    
    function removeLogo(team) {
        ws.send(JSON.stringify({ action: "removeLogo", team }));
    }

    function uploadSponsorLogo() {
      const fileInput = document.getElementById("sponsorLogoFile");
      if (fileInput.files[0]) {
        const reader = new FileReader();
        reader.onload = () => {
          ws.send(JSON.stringify({
            action: "uploadSponsorLogo",
            logo: reader.result
          }));
        };
        reader.readAsDataURL(fileInput.files[0]);
      }
    }

    function removeSponsorLogo() {
        ws.send(JSON.stringify({ action: "removeSponsorLogo" }));
    }

    function changeScore(team, amount) {
      let homeScore = scoreboardState.homeScore;
      let awayScore = scoreboardState.awayScore;
      if (team === "home") homeScore += amount;
      else awayScore += amount;
      if (homeScore < 0) homeScore = 0;
      if (awayScore < 0) awayScore = 0;
      ws.send(JSON.stringify({ action: "updateScores", homeScore, awayScore }));
    }

    function sendAction(action) { ws.send(JSON.stringify({ action })); }
    
    function setManualTimer() {
      const minutes = parseInt(document.getElementById("manualTimerMinutes").value) || 0;
      const seconds = parseInt(document.getElementById("manualTimerSeconds").value) || 0;
      ws.send(JSON.stringify({ 
        action: "setManualTimer", 
        minutes: minutes,
        seconds: seconds
      }));
    }

    function setExtraTimes() {
        ws.send(JSON.stringify({
            action: "setExtraTimes",
            extra1: parseInt(document.getElementById("extraTime1").value),
            extra2: parseInt(document.getElementById("extraTime2").value)
        }));
    }
    
    function toggleScoreboard() {
        ws.send(JSON.stringify({ action: "toggleScoreboard" }));
    }
  </script>
</body>

</html>


